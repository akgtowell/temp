<!--
 '  Created By   : Ankur Shah
 '  Created Date : 02/02/2012
 '  Description  : This page is used for print document.
-->
<!DOCTYPE html>
<html>
<head>
<title>Print Documents</title>
<meta name="viewport"
	content="width=device-width, initial-scale=1.0;maximum-scale=1.0;user-scalable=0; target-densitydpi=device-dpi">
<meta name="format-detection" content="telephone=no">
<link rel="stylesheet" href="../css/jquery.mobile-1.0.min.css" />
<link rel="stylesheet" href="../css/style.css" />
<link rel="stylesheet" href="../css/en.css" lang="en" />
<link rel="stylesheet"
	media="only screen and (min-width: 320px) and (max-width: 600px)"
	href="../css/style_600.css">
<link rel="stylesheet"
	media="only screen and (min-width: 601px) and (max-width: 700px)"
	href="../css/style_700.css">
<link rel="stylesheet"
	media="only screen and (min-width: 700px) and (max-width: 800px)"
	href="../css/style_800.css">
<link rel="stylesheet"
	media="only screen and (min-width: 1000px) and (max-width: 1200px)"
	href="../css/style_1200.css">
<link rel="stylesheet"
	media="only screen and (min-width: 1200px) and (max-width: 1500px)"
	href="../css/style_1400.css">

	<link rel="stylesheet" href="../css/boostrap/css/bStyle.css"/>
        <link rel="stylesheet" href="../css/boostrap/css/bootstrap.min.css"/>
        <link rel="stylesheet" href="../css/boostrap/css/bootstrap-grid.css"/>
        <link rel="stylesheet" href="../css/boostrap/css/bootstrap-grid.min.css"/>
        <link rel="stylesheet" href="../css/boostrap/css/bootstrap.css"/>

<script type="text/javascript" src="../js/jquery.js"></script>

<script type="text/javascript" src="../js/jquery.mobile-1.0.js"></script>

<script type="text/javascript" src="../js/common.js"></script>

<script type="text/javascript" src="../js/printreportmultiple.js"></script>

<script src="../LangJS/jquery-lang.js" charset="utf-8"
	type="text/javascript"></script>

<script src="../LangJS/langpack/AR.js" charset="utf-8"
	type="text/javascript" lang="en"></script>

<script>
	if (navigator.userAgent.toLowerCase().match(/android/)) {
		document
				.write('<script charset="utf-8" src="../cordova-2.0.0.js"><\/script>');
		document
				.write('<script charset="utf-8" src="../directoryListing.js"><\/script>');
	} else if (navigator.userAgent.toLowerCase().match(/iphone/)
			|| navigator.userAgent.toLowerCase().match(/ipad/)) {
		document
				.write('<script charset="utf-8" src="../cordova-1.5.0.js"><\/script>');
	}
</script>
</head>
<body>
	<div data-role="page" data-theme="d">
		<div>
			<img title="" alt="" src="../images/bg.png" id="background">
		</div>
		<div data-role="header" data-position="inline" id="bgclheader">
			<a href="../information/information.html" id="Back_inner"
				rel="external" lang="en">Back</a>
			<div class="wrapper">
				<div class="card_content">
					<div>
						<img title="" alt="" data-pushbar-target="left"
							src="../images/icons8-menu-50.png" id="setting">
					</div>
				</div>
			</div>
			<h1 lang="en">Print Documents</h1>
			<a href="#" id="lang_inner">EN</a>
		</div>
		<div data-role="content" class="centerbox">
			<div class="book_detail_div" style="height:800px !important">
				<table style="width: 50%">
					<tr>
						<td style="width: 30%" lang="en">
							FILTER BY
						</td>
						<td style="width: 70%;">
							<div>
								<select class="form-control" name="select-choice-1" id="ddlTransaction" 
									style="display: inline;width:100%">
									<option>--ALL--</option>
									<option value="in">Inventory (INV)</option>
									<option value="si">Sales (SI)</option>
									<option value="cn">Return (CN)</option>
									<option value="or">Order (OR)</option>
									<option value="co">Collection (CO)</option>
									<option value="ad">Advance Payment (AD)</option>
								</select>
							</div>
						</td>
					</tr>
				</table>
				<div class="tblBox tbltd">
					<div>
						<table width="100%" id="tblHeaderContent" cellpadding="0"
							cellspacing="0" class="tblHeader">
							<!--<tr>
                             <td lang="en" class="last">
                             Select Customer
                             </td>
                             </tr>-->
							<tr>
								<th style="width: 8%;"><img id="imgSelectAll"
									src="../images/check.png" alt="check"
									style="vertical-align: middle;" /></th>
								<th style="width: 22%;" lang="en">Customer #</th>
								<th style="width: 35%; display: none;" lang="en">Name</th>
								<th style="width: 25%" lang="en">Transaction #</th>
								<!--<th style="width:25%" lang="en">
                                    Amount
                                </th>-->
								<th style="width: 20%" lang="en">Type</th>
							</tr>
						</table>
					</div>
					<div style="table-layout: initial;"
						class="route_table_height tblFixedHeight" id="contentWrapper">
						<table border="0" width="100%" cellpadding="0" cellspacing="0"
							id="tbl1">
							<tr>
								<td style="width: 8%;"></td>
								<td style="width: 22%"></td>
								<td style="width: 35%; display: none;"></td>
								<td style="width: 25%;"></td>
								<!--<td style="width:25%">
                                </td>-->
								<td style="width: 20%"></td>
							</tr>
						</table>
					</div>
				</div>
				<div class="leftbotloadTrf card border-info">				
					<div class="row">
						<div class="col-3"></div>
		                <div class="col-3" style="margin:10px !important">
		                        <div class="card bg-success text-center">
		                            <a href="#" class="enableText" rel="external" onclick="PrintDocument();">
		                                <img class="bottomicon" src="../images/print.png" alt="sync" />
		                                <h4 class="text-white">PRINT</h4>
		                            </a>
		                        </div>                        
		                 </div>
		                 <div class="col-3" style="margin:10px !important">
		                        <div class="card bg-danger text-center">
		                            <a href="../information/information.html" rel="external">
		                            <img class="bottomicon" src="../images/icn-exit.png" id="imgexit" alt="Exit" />
		                            <h4 class="text-white">DONE</h4>
		                            </a>
		                        </div>                        
		                 </div>
		                 <div class="col-3"></div>
					</div>				
				</div>		
			</div>

			
		</div>
		<div id="f1" data-role="footer" class="ui-bar">
			<div class="footer">
				<div class="leftfooter">09 November 2011</div>
				<div class="rightfooter">Mirnah Technology Systems</div>
			</div>
		</div>
		<div id="f2" data-role="footer" style="bottom: 0; position: absolute;">

			<aside data-pushbar-id="left" class="pushbar from_left">
				<div class="title">
					<span data-pushbar-close class="close push_right"></span> <span
						id="txtroute"></span>
				</div>

				<ul class="menu">
					<li style="margin-bottom: 0 !important;"><img title="" alt=""
						src="../images/startday-icon.png" id="day" class="leftmenu">
						<a href="#" class="ui-btn-active" rel="external" id="day"
						data-icon="custom" lang="en"
						onclick="footerredict('../startofday/startofday.html')">Start
							day</a></li>
					<li style="margin-bottom: 0 !important;"><img title="" alt=""
						src="../images/Inventoryicon.png" id="inve" class="leftmenu">
						<a href="#" id="inve" rel="external" data-icon="custom" lang="en"
						onclick="footerredict('../inventory/inventory.html')">Inventory</a></li>
					<li style="margin-bottom: 0 !important;"><img title="" alt=""
						src="../images/customer-icon.png" id="cust" class="leftmenu">
						<a href="#" rel="external" id="cust" data-icon="custom" lang="en"
						onclick="footerredict('../customer/customer_operation.html')">Customer</a></li>
					<li style="margin-bottom: 0 !important;"><img title="" alt=""
						src="../images/Money-icon.png" id="sett" class="leftmenu"> <a
						href="#" rel="external" id="sett" data-icon="custom" lang="en"
						onclick="footerredict('../settlement/managesettlement.html')">Settlement</a></li>
					<li style="margin-bottom: 0 !important;"><img title="" alt=""
						src="../images/expense-icon.png" id="expe" class="leftmenu">
						<a href="#" rel="external" id="expe" data-icon="custom" lang="en"
						onclick="footerredict('../settlement/expenseentry.html')">Expenses</a></li>
					<li style="margin-bottom: 0 !important;"><img title="" alt=""
						src="../images/information-icon.png" id="info" class="leftmenu">
						<a href="#" rel="external" id="info" data-icon="custom" lang="en"
						onclick="footerredict('../information/information.html')">Information</a></li>
					<li style="margin-bottom: 0 !important;"><img title="" alt=""
						src="../images/user-settings-icon.png" id="setup" class="leftmenu">
						<a href="#" rel="external" id="setup" data-icon="custom" lang="en"
						onclick="footerredict('../utilities/utilities.html')">Utilities</a></li>
				</ul>

			</aside>

			<div data-role="navbar" data-iconpos="top" data-grid="f">
				<ul>
					<li style="margin-bottom: 0 !important;"><a href="#"
						rel="external" id="day" data-icon="custom" lang="en"
						onclick="footerredict('../startofday/startofday.html')">Start
							day</a></li>
					<li style="margin-bottom: 0 !important;"><a href="#" id="inve"
						rel="external" data-icon="custom" lang="en"
						onclick="footerredict('../inventory/inventory.html')">Inventory</a></li>
					<li style="margin-bottom: 0 !important;"><a href="#"
						rel="external" id="cust" data-icon="custom" lang="en"
						onclick="footerredict('../customer/customer_operation.html')">Customer</a></li>
					<li style="margin-bottom: 0 !important;"><a href="#"
						rel="external" id="sett" data-icon="custom" lang="en"
						onclick="footerredict('../settlement/managesettlement.html')">Settlement</a></li>
					<li style="margin-bottom: 0 !important;"><a href="#"
						rel="external" id="expe" data-icon="custom" lang="en"
						onclick="footerredict('../settlement/expenseentry.html')">Expenses</a></li>
					<li style="margin-bottom: 0 !important;"><a href="#"
						class="ui-btn-active" rel="external" id="info" data-icon="custom"
						lang="en"
						onclick="footerredict('../information/information.html')">Information</a></li>
					<li style="margin-bottom: 0 !important; width: 14.0%"><a
						href="#" rel="external" id="setup" data-icon="custom" lang="en"
						onclick="footerredict('../utilities/utilities.html')">Utilities</a></li>
				</ul>
			</div>
		</div>
	</div>

	<script type="text/javascript" language="javascript">
		window.lang = new jquery_lang_js();
		$("#tbl1").click(function() {
		});
		$('label').css({
			'background' : '#D1ECFD',
			'border' : 'none'
		});
		$('.ui-btn-inner').css({
			'border-top' : 'none'
		});
		var flag = 0;
		var platform;
		var data = [];
		var selRow, issync;
		;
		var decimalplace = sessionStorage.getItem("decimalplace");
		var directbind = false;
		resizeOrientationWindow();
		$(document)
				.ready(
						function() {
							resizeWindow();

							//Set current date in footer
							$(".leftfooter").html(getCurrentDate());

							//Fetch current language and set that language.
							var lan = sessionStorage.getItem("Language");
							window.lang.run(lan);

							platform = sessionStorage.getItem("platform");
							/*if (sessionStorage.getItem("RouteKey") =='' || sessionStorage.getItem("RouteKey")==0 || sessionStorage.getItem("RouteKey") == null)
							    {
							    document.addEventListener("deviceready", getafterRouteKey, false);
							    }else
							        {*/
							document.addEventListener("deviceready",
									getSalesSI, false);
							///      }
							// sujee added side bar ----------------- START ------------------------ 

							var pushbar = new Pushbar({
								blur : true,
								overlay : true,
							});
							$("#txtroute").text(
									"ROUTE #: "
											+ sessionStorage
													.getItem("RouteCode"));
							window.setInterval(function() {
								var randomColor = '#'
										+ ('000000' + Math.floor(
												Math.random() * 16777215)
												.toString(16)).slice(-6);
								$('#txtroute').css({
									'color' : randomColor,
								});
							}, 2000);
							//----------------------------- END -------------------------  
							$("#ddlTransaction").change(function() {
								ChangeTransaction(this)
							});

							//Table header radius
							$("#tbl1 tr:first th").addClass(
									'tableBorderTopLeft tableBorderTopRight');

							//Check for current language and set css for that
							if (sessionStorage.getItem("Language") != "en") {
								window.lang.change('PrintDocument' + lan, lan);
								window.lang.change('Footer' + lan, lan);

								if (lan == "AR") {
									//Set html right alignment for arbic language
									$(".centerbox").attr("dir", "rtl");

									//Set header align                
									$('#Back_inner')
											.removeClass(
													'ui-btn-left ui-btn ui-btn-corner-all ui-shadow ui-btn-up-a');
									$('#Back_inner')
											.addClass(
													'ui-btn-right ui-btn ui-btn-corner-all ui-shadow ui-btn-up-a');
									$('#lang_inner')
											.removeClass(
													'ui-btn-right ui-btn ui-btn-corner-all ui-shadow ui-btn-up-a');
									$('#lang_inner')
											.addClass(
													'ui-btn-left ui-btn ui-btn-corner-all ui-shadow ui-btn-up-a');
								}
							} else {
								//Change current language to english
								window.lang.change('en', 'en');

								//Set html left alignment for english language
								$(".centerbox").attr("dir", "ltr");

								//Set header align              
								$('#Back_inner')
										.removeClass(
												'ui-btn-right ui-btn ui-btn-corner-all ui-shadow ui-btn-up-a');
								$('#Back_inner')
										.addClass(
												'ui-btn-left ui-btn ui-btn-corner-all ui-shadow ui-btn-up-a');
								$('#lang_inner')
										.removeClass(
												'ui-btn-left ui-btn ui-btn-corner-all ui-shadow ui-btn-up-a');
								$('#lang_inner')
										.addClass(
												'ui-btn-right ui-btn ui-btn-corner-all ui-shadow ui-btn-up-a');
							}

							$("#imgSelectAll").click(function() {
								flag = 0;
								toogle("#imgSelectAll");
							});

							//
							function getafterRouteKey() {
								platform = sessionStorage.getItem("platform");

								if (platform == 'iPad') {
									Cordova
											.exec(
													function(result) {
														if (result > 0) {
															sessionStorage
																	.setItem(
																			"RouteKey",
																			result[0][0]);

														}

													},
													function(error) {
														alert("Error in getting salesman : "
																+ error);
													},
													"PluginClass",
													"GetdataMethod",
													[ "select max(routekey) from startendday where routecode = "
															+ sessionStorage
																	.getItem('RouteCode')
															+ " and salesmancode = "
															+ sessionStorage
																	.getItem('SalesmanCode')
															+ " and routeclosed=0" ]);
								} else if (platform == 'Android') {

									window.plugins.DataBaseHelper
											.select(
													"select max(routekey) routekey from startendday where routecode = "
															+ sessionStorage
																	.getItem('RouteCode')
															+ " and salesmancode = "
															+ sessionStorage
																	.getItem('SalesmanCode')
															+ "",
													function(result) {
														if (result.array != undefined) {

															if (result.array[0].routekey > 0) {
																sessionStorage
																		.setItem(
																				"RouteKey",
																				result.array[0].routekey);

																getSalesSI();
															}

														}
													},
													function() {
														console
																.warn("Error calling plugin");
													});
								}
							}

							//

							function BindData1() {

								var CellCount = $("#tbl1 tr:eq(0) th").length;
								var data = [ [ 'Sales 657456' ],
										[ 'Sales 657456' ], [ 'Sales 657456' ],
										[ 'Sales 657456' ], [ 'Sales 657456' ],
										[ 'Sales 657456' ] ]

								for (i = 0; i < data.length; i++) {
									var r = "<tr>";
									r += "<td><img id=imgCheck"
											+ (i + 1)
											+ " src='../images/check.png' alt='check' style='vertical-align: middle;' class='chk'/></td>"
									for (j = 0; j < 1; j++) {
										var c = "<td " + ">" + data[i][j]
												+ "</td>";
										r += c;
									}
									r += "</tr>";
									$('#tbl1 tbody').append(r);
								}

							}

						});
		function getInventory() {
			//var Qry = "SELECT '-' AS customercode,case when transactiontype=1 then 'Load' when transactiontype=3 then 'Unload' when transactiontype=2 then 'Load Transfer' when transactiontype=4 then 'Load Request' end as customername,CAST(documentnumber AS VARCHAR) as invoicenumber,0 as amount,'INV' as lbl1,'Inventory' as lbl2,invh.issync,detailkey,CAST(hhcdocumentnumber AS varchar) as invnum,documentnumber as docnum FROM inventorytransactionheader invh where invh.routekey = " + sessionStorage.getItem("RouteKey") + " and istemp = 'false' order by documentnumber";
			//var Qry = "SELECT '-' AS customercode,case when transactiontype=1 then 'Load' when transactiontype=3 then 'Unload' when transactiontype=2 then 'Load Transfer' when transactiontype=4 then 'Load Request' end as customername,CAST(documentnumber AS VARCHAR) as invoicenumber,'INV' as lbl1,'Inventory' as lbl2,invh.issync,detailkey,CAST(hhcdocumentnumber AS varchar) as invnum,documentnumber as docnum FROM inventorytransactionheader invh where invh.routekey = " + sessionStorage.getItem("RouteKey") + " and istemp = 'false' order by documentnumber";
			//console.log(Qry);
			var Qry = "SELECT '-' AS customercode,case when transactiontype=1 and loadnumber!=0 then 'Load' when transactiontype=3 then 'Unload' when transactiontype=2 then 'Load Transfer' when transactiontype=4 then 'Load Request' end as customername, CAST(documentnumber AS VARCHAR) as invoicenumber, 'INV' as lbl1, 'Inventory' as lbl2,invh.issync,detailkey,CAST(hhcdocumentnumber AS varchar) as invnum,documentnumber as docnum FROM inventorytransactionheader invh where invh.routekey  = "
					+ sessionStorage.getItem("RouteKey")
					+ " and customername!='null' and istemp = 'false'  order by documentnumber";
			console.log(Qry);

			if (platform == "iPad") {
				Cordova.exec(function(result) {
					try {
						if (result.length > 0) {
							if (data != undefined) {
								tmpdata = data.concat(result);
								data = tmpdata;
							} else
								data = result;
						}
					} catch (ex) {
						alert(ex);
					}
					if (!directbind)
						getOrder();
					else
						BindData();

				}, function(error) {
					alert("Error in binding Bank Name : " + error);
				}, "PluginClass", "GetdataMethod", [ Qry ]);
			} else if (platform == "Android") {
				window.plugins.DataBaseHelper.select(Qry, function(result) {
					if (result.array != undefined) {

						var result = $.map(result.array, function(item, index) {
							//return [[item.customercode,item.customername,item.invoicenumber,item.amount,item.lbl1,item.lbl2,item.issync,item.detailkey,item.invnum,item.docnum]];
							return [ [ item.customercode, item.customername,
									item.invoicenumber, item.lbl1, item.lbl2,
									item.issync, item.detailkey, item.invnum,
									item.docnum ] ];
						});

						console.log(result);
						if (data != undefined) {
							tmpdata = data.concat(result);
							data = tmpdata;
						} else
							data = result;
					}
					if (!directbind)
						getOrder();
					else
						BindData();
				}, function() {
					console.warn("Error calling plugin");
				});
			}
		}
		function getSalesSI() {

			// var Qry = "SELECT (SELECT CASE usealternatecodes WHEN 1 THEN cm.alternatecode ELSE cm.customercode END FROM routemaster WHERE routecode=" + sessionStorage.getItem("RouteCode") + ") AS customercode,customername,invoicenumber,ifnull(invh.totalinvoiceamount,0) as amount,'SA' as lbl1,'Sales' as lbl2,invh.issync,transactionkey,CAST(invoicenumber AS VARCHAR) as invnum,documentnumber as docnum FROM customermaster cm JOIN invoiceheader invh on cm.customercode = invh.customercode and invh.routekey = " + sessionStorage.getItem("RouteKey") + " and voidflag IS NOT 1 WHERE istemp = 'false' order by documentnumber";
			var Qry = "SELECT (SELECT CASE usealternatecodes WHEN 1 THEN cm.alternatecode ELSE cm.customercode END FROM routemaster WHERE routecode="
					+ sessionStorage.getItem("RouteCode")
					+ ") AS customercode,customername,invoicenumber,'SI' as lbl1,'Sales' as lbl2,invh.issync,transactionkey,CAST(invoicenumber AS VARCHAR) as invnum,documentnumber as docnum FROM customermaster cm JOIN invoiceheader invh on cm.customercode = invh.customercode and invh.routekey = "
					+ sessionStorage.getItem("RouteKey")
					+ " and voidflag IS NOT 1 WHERE istemp = 'false' and (dexflag=0 OR dexflag=2) order by documentnumber";
			console.log(Qry);
			if (platform == "iPad") {
				Cordova.exec(function(result) {
					if (eval(result.length) > 0) {
						data = result;
					}
					if (!directbind)
						getInventory();
					else
						BindData();
				}, function(error) {
					alert("Error in binding Bank Name : " + error);
				}, "PluginClass", "GetdataMethod", [ Qry ]);
			} else if (platform == "Android") {
				window.plugins.DataBaseHelper.select(Qry, function(result) {
					if (result.array != undefined) {
						var result = $.map(result.array, function(item, index) {
							//return [[item.customercode,item.customername,item.invoicenumber,item.amount,item.lbl1,item.lbl2,item.issync,item.transactionkey,item.invnum,item.docnum]];
							return [ [ item.customercode, item.customername,
									item.invoicenumber, item.lbl1, item.lbl2,
									item.issync, item.transactionkey,
									item.invnum, item.docnum ] ];
						});
						data = result;
					}
					if (!directbind)
						getSalesCN();
					else
						BindData();
				}, function() {
					console.warn("Error calling plugin");
				});
			}
		}

		function getSalesCN() {

			// var Qry = "SELECT (SELECT CASE usealternatecodes WHEN 1 THEN cm.alternatecode ELSE cm.customercode END FROM routemaster WHERE routecode=" + sessionStorage.getItem("RouteCode") + ") AS customercode,customername,invoicenumber,ifnull(invh.totalinvoiceamount,0) as amount,'SA' as lbl1,'Sales' as lbl2,invh.issync,transactionkey,CAST(invoicenumber AS VARCHAR) as invnum,documentnumber as docnum FROM customermaster cm JOIN invoiceheader invh on cm.customercode = invh.customercode and invh.routekey = " + sessionStorage.getItem("RouteKey") + " and voidflag IS NOT 1 WHERE istemp = 'false' order by documentnumber";
			var Qry = "SELECT (SELECT CASE usealternatecodes WHEN 1 THEN cm.alternatecode ELSE cm.customercode END FROM routemaster WHERE routecode="
					+ sessionStorage.getItem("RouteCode")
					+ ") AS customercode,customername,invoicenumber,'CN' as lbl1,'Sales' as lbl2,invh.issync,transactionkey,CAST(invoicenumber AS VARCHAR) as invnum,documentnumber as docnum FROM customermaster cm JOIN invoiceheader invh on cm.customercode = invh.customercode and invh.routekey = "
					+ sessionStorage.getItem("RouteKey")
					+ " and voidflag IS NOT 1 WHERE istemp = 'false' and dexflag=1 order by documentnumber";

			if (platform == "iPad") {
				Cordova.exec(function(result) {
					if (eval(result.length) > 0) {
						data = result;
					}
					if (!directbind)
						getInventory();
					else
						BindData();
				}, function(error) {
					alert("Error in binding Bank Name : " + error);
				}, "PluginClass", "GetdataMethod", [ Qry ]);
			} else if (platform == "Android") {
				window.plugins.DataBaseHelper.select(Qry, function(result) {
					if (result.array != undefined) {
						var result = $.map(result.array, function(item, index) {
							//return [[item.customercode,item.customername,item.invoicenumber,item.amount,item.lbl1,item.lbl2,item.issync,item.transactionkey,item.invnum,item.docnum]];
							return [ [ item.customercode, item.customername,
									item.invoicenumber, item.lbl1, item.lbl2,
									item.issync, item.transactionkey,
									item.invnum, item.docnum ] ];
						});
						if (data != undefined) {
							tmpdata = data.concat(result);
							data = tmpdata;
						} else {
							data = result;
						}
					}

					if (!directbind)
						getInventory();
					else
						BindData();
				}, function() {
					console.warn("Error calling plugin");
				});
			}
		}

		function getOrder() {
			//var Qry = "SELECT (SELECT CASE usealternatecodes WHEN 1 THEN cm.alternatecode ELSE cm.customercode END FROM routemaster WHERE routecode=" + sessionStorage.getItem("RouteCode") + ") AS customercode,customername,invoicenumber,(ifnull(totalsalesamount,0)-ifnull(totalreturnamount,0)-ifnull(totalpromoamount,0)-ifnull(totaldamagedamount,0)) as amount,'OR' as lbl1,'Order' as lbl2,ordh.issync,transactionkey,CAST(invoicenumber AS VARCHAR) as invnum,documentnumber as docnum FROM customermaster cm JOIN salesorderheader ordh on cm.customercode = ordh.customercode and ordh.routekey = " + sessionStorage.getItem("RouteKey") + " and voidflag IS NOT 1 WHERE istemp = 'false' order by documentnumber";
			var Qry = "SELECT (SELECT CASE usealternatecodes WHEN 1 THEN cm.alternatecode ELSE cm.customercode END FROM routemaster WHERE routecode="
					+ sessionStorage.getItem("RouteCode")
					+ ") AS customercode,customername,invoicenumber,'OR' as lbl1,'Order' as lbl2,ordh.issync,transactionkey,CAST(invoicenumber AS VARCHAR) as invnum,documentnumber as docnum FROM customermaster cm JOIN salesorderheader ordh on cm.customercode = ordh.customercode and ordh.routekey = "
					+ sessionStorage.getItem("RouteKey")
					+ " and voidflag IS NOT 1 WHERE istemp = 'false' order by documentnumber";
			var tmpdata;
			if (platform == "iPad") {
				Cordova.exec(function(result) {
					if (result.length > 0) {
						if (data != undefined) {
							tmpdata = data.concat(result);
							data = tmpdata;
						} else
							data = result;
					}

					if (!directbind)
						getAR("any");
					else
						BindData();
				}, function(error) {
					alert("Error in binding Bank Name : " + error);
				}, "PluginClass", "GetdataMethod", [ Qry ]);
			} else if (platform == "Android") {
				window.plugins.DataBaseHelper.select(Qry, function(result) {
					if (result.array != undefined) {
						var result = $.map(result.array, function(item, index) {
							// return [[item.customercode,item.customername,item.invoicenumber,item.amount,item.lbl1,item.lbl2,item.issync,item.transactionkey,item.invnum,item.docnum]];
							return [ [ item.customercode, item.customername,
									item.invoicenumber, item.lbl1, item.lbl2,
									item.issync, item.transactionkey,
									item.invnum, item.docnum ] ];
						});
						if (data != undefined) {
							tmpdata = data.concat(result);
							data = tmpdata;
						} else
							data = result;
					}

					if (!directbind)
						getAR("any");
					else
						BindData();
				}, function() {
					console.warn("Error calling plugin");
				});
			}
		}

		function getAR(type) {
			if (type == "any")
				//var Qry = "SELECT (SELECT CASE usealternatecodes WHEN 1 THEN cm.alternatecode ELSE cm.customercode END FROM routemaster WHERE routecode=" + sessionStorage.getItem("RouteCode") + ") AS customercode,customername,invoicenumber,ifnull(arh.amountpaid,0) as amount,(CASE WHEN advancepaymentflag = 1 THEN 'AD' ELSE 'CO' END) as lbl1,'Collection' as lbl2,arh.issync,transactionkey,CAST(invoicenumber AS VARCHAR) as invnum,documentnumber as docnum FROM customermaster cm JOIN arheader arh on cm.customercode = arh.customercode and arh.routekey = " + sessionStorage.getItem("RouteKey") + " and voidflag IS NOT 1 WHERE amountpaid <> 0 order by documentnumber";
				var Qry = "SELECT (SELECT CASE usealternatecodes WHEN 1 THEN cm.alternatecode ELSE cm.customercode END FROM routemaster WHERE routecode="
						+ sessionStorage.getItem("RouteCode")
						+ ") AS customercode,customername,invoicenumber,(CASE WHEN advancepaymentflag = 1 THEN 'AD' ELSE 'CO' END) as lbl1,(CASE WHEN advancepaymentflag = 1 THEN 'advance' ELSE 'Collection' END) as lbl2,arh.issync,transactionkey,CAST(invoicenumber AS VARCHAR) as invnum,documentnumber as docnum FROM customermaster cm JOIN arheader arh on cm.customercode = arh.customercode and arh.routekey = "
						+ sessionStorage.getItem("RouteKey")
						+ " and voidflag IS NOT 1 WHERE amountpaid <> 0 order by documentnumber";
			else if (type == "co")
				//var Qry = "SELECT (SELECT CASE usealternatecodes WHEN 1 THEN cm.alternatecode ELSE cm.customercode END FROM routemaster WHERE routecode=" + sessionStorage.getItem("RouteCode") + ") AS customercode,customername,invoicenumber,ifnull(arh.amountpaid,0) as amount,'CO' AS lbl1,'Collection' as lbl2,arh.issync,transactionkey,CAST(invoicenumber AS VARCHAR) as invnum,documentnumber as docnum FROM customermaster cm JOIN arheader arh on cm.customercode = arh.customercode and arh.routekey = " + sessionStorage.getItem("RouteKey") + " and voidflag IS NOT 1 WHERE amountpaid <> 0 AND advancepaymentflag is not 1 order by documentnumber";
				var Qry = "SELECT (SELECT CASE usealternatecodes WHEN 1 THEN cm.alternatecode ELSE cm.customercode END FROM routemaster WHERE routecode="
						+ sessionStorage.getItem("RouteCode")
						+ ") AS customercode,customername,invoicenumber,'CO' AS lbl1,'Collection' as lbl2,arh.issync,transactionkey,CAST(invoicenumber AS VARCHAR) as invnum,documentnumber as docnum FROM customermaster cm JOIN arheader arh on cm.customercode = arh.customercode and arh.routekey = "
						+ sessionStorage.getItem("RouteKey")
						+ " and voidflag IS NOT 1 WHERE amountpaid <> 0 AND advancepaymentflag is not 1 order by documentnumber";
			else if (type == "ad")
				//var Qry = "SELECT (SELECT CASE usealternatecodes WHEN 1 THEN cm.alternatecode ELSE cm.customercode END FROM routemaster WHERE routecode=" + sessionStorage.getItem("RouteCode") + ") AS customercode,customername,invoicenumber,ifnull(arh.amountpaid,0) as amount,'AD' as lbl1,'Collection' as lbl2,arh.issync,transactionkey,CAST(invoicenumber AS VARCHAR) as invnum,documentnumber as docnum FROM customermaster cm JOIN arheader arh on cm.customercode = arh.customercode and arh.routekey = " + sessionStorage.getItem("RouteKey") + " and voidflag IS NOT 1 WHERE amountpaid <> 0 AND advancepaymentflag = 1 order by documentnumber";
				var Qry = "SELECT (SELECT CASE usealternatecodes WHEN 1 THEN cm.alternatecode ELSE cm.customercode END FROM routemaster WHERE routecode="
						+ sessionStorage.getItem("RouteCode")
						+ ") AS customercode,customername,invoicenumber,'AD' as lbl1,'advance' as lbl2,arh.issync,transactionkey,CAST(invoicenumber AS VARCHAR) as invnum,documentnumber as docnum FROM customermaster cm JOIN arheader arh on cm.customercode = arh.customercode and arh.routekey = "
						+ sessionStorage.getItem("RouteKey")
						+ " and voidflag IS NOT 1 WHERE amountpaid <> 0 AND advancepaymentflag = 1 order by documentnumber";
			console.log(Qry);
			var tmpdata;
			if (platform == "iPad") {
				Cordova.exec(function(result) {
					if (result.length > 0) {
						if (data != undefined) {
							tmpdata = data.concat(result);
							data = tmpdata;
						} else
							data = result;
					}
					BindData();
				}, function(error) {
					alert("Error in binding Bank Name : " + error);
				}, "PluginClass", "GetdataMethod", [ Qry ]);
			} else if (platform == "Android") {
				window.plugins.DataBaseHelper.select(Qry, function(result) {
					if (result.array != undefined) {
						result = $.map(result.array, function(item, index) {
							//return [[item.customercode,item.customername,item.invoicenumber,item.amount,item.lbl1,item.lbl2,item.issync,item.transactionkey,item.invnum,item.docnum]];
							return [ [ item.customercode, item.customername,
									item.invoicenumber, item.lbl1, item.lbl2,
									item.issync, item.transactionkey,
									item.invnum, item.docnum ] ];
						});
						if (data != undefined) {
							tmpdata = data.concat(result);
							data = tmpdata;
						} else
							data = result;
					}
					BindData();
				}, function() {
					console.warn("Error calling plugin");
				});
			}
		}

		function BindData() {
			SortByDocumentNumber();
			ClearTable("tbl1");
			var CellCount = $("#tblHeaderContent tr:eq(0) th").length;
			for (var i = 0; i < data.length; i++) {
				var r = "<tr class='contentFont'>";
				r += "<td><img id='imgCheck"
						+ (i + 1)
						+ "' src='../images/check.png' alt='check' style='vertical-align: middle;' class='chk'/></td>";
				for (j = 0; j < CellCount - 1; j++) {
					var c = '';
					var temp;
					temp = "padding-left:10px;"
					if (j == 1) {
						temp += "display:none;";
					}
					/*if(j==3)
					{
					    
					  //  data[i][j] = eval(data[i][j]).toFixed(decimalplace);
					   // temp += "text-align:right;padding-right:10px;";
					   // temp += "display:none;";
					}*/
					if (j == 2)
						data[i][j] = parseInt(data[i][j]);

					c = "<td style='" + temp + "'>" + data[i][j] + "</td>";
					r += c;
					temp = '';
				}
				r += "</tr>";
				$('#tbl1 tbody').append(r);
			}

			$("#tbl1 tr:odd").addClass('oddRow');
			$("#tbl1 tr:even").addClass('evenRow');
			$(".chk").click(function() {
				var id = "#" + $(this).attr("id");

				toogle(id);
			});
			/*   $("#tbl1 tr").live('click', function() {
			                      $(this).toggleClass('clicked');
			                      $(this).siblings().removeClass('clicked');
			                      var i=$(this).index();
			                      if($(this).hasClass("clicked"))
			                      {
			                      selRow = i;
			                      issync = data[i - 1][6];                        
			                      }
			                      else
			                      selRow = undefined;
			                      });
			   $("#tbl1 tr:eq(1)").trigger('click');    */
		}

		function SortByDocumentNumber() {
			var temp;
			for (i = 0; i < data.length - 1; i++) {
				for (j = 0; j < data.length - 1; j++) {
					if (parseInt(eval(data[j][8])) > parseInt(eval(data[j + 1][8]))) {
						temp = data[j];
						data[j] = data[j + 1];
						data[j + 1] = temp;
					}
				}
			}
		}

		function toogle(element) {

			if ($(element).attr("src") == '../images/check.png') {
				$(element).attr("src", "../images/check-box.png");

				if (element == '#imgSelectAll') {
					$(".chk").attr("src", "../images/check-box.png");
				}

				if (element != '#imgSelectAll') {
					flag += 1;
					if ($(".chk").length == flag)
						$("#imgSelectAll").attr("src",
								"../images/check-box.png");
				}
			} else {
				$(element).attr("src", "../images/check.png");

				if (element == '#imgSelectAll') {
					$(".chk").attr("src", "../images/check.png");
				}

				if (element != '#imgSelectAll') {
					flag -= 1;
					if ($(".chk").length != flag)
						$("#imgSelectAll").attr("src", "../images/check.png");
				}
			}
		}
		function ChangeTransaction(obj) {
			if ($(obj).get(0).selectedIndex != 0) {
				data = undefined;

				if ($(obj).val() == "si") {
					directbind = true;
					getSalesSI();
				} else if ($(obj).val() == "cn") {
					directbind = true;
					getSalesCN();
				} else if ($(obj).val() == "in") {
					directbind = true;
					getInventory();
				} else if ($(obj).val() == "or") {
					directbind = true;
					getOrder();
				} else if ($(obj).val() == "co") {
					directbind = true;
					getAR("co");
				} else if ($(obj).val() == "ad") {
					directbind = true;
					getAR("ad");
				}
			} else {
				data = undefined;
				directbind = false;
				getSalesSI(directbind);
			}
		}

		function ClearTable(TBL) {
			$("#" + TBL + " tr:gt(0)").remove();
			$("#" + TBL + " tr").die('click');
		}

		function PrintDocument() {
			var arr = [];
			try {
				var elm = $(".chk");
				var fileName = "";
				var idx;
				if (elm.length > 0) {

					for (i = 0; i < elm.length; i++) {
						if ($(elm[i]).attr("src") == "../images/check-box.png") {
							var ReportName = data[i][1];
							var ReportName1 = data[i][1];
							var key = data[i][6];
							var invnum = eval(data[i][7]).toString();
							if (data[i][4] == "Sales") {
								ReportName = data[i][4];
							}
							if (data[i][4] == "Collection") {
								ReportName = data[i][4];

							}
							if (data[i][4] == "advance") {
								ReportName = data[i][4];
							}
							if (data[i][4] == "Order") {
								ReportName = data[i][4];
							}
							/*if(data[i][1] == "Unload")
							    {
							        PrintSelectedReports();
							    }
							if(data[i][1] != "Unload")
							{*/
							arr.push({
								"ReportName" : ReportName,
								"key" : key,
								"invoicenumber" : invnum
							});
							//}

						}
					}
					getOfflineSetting(arr);
					console.log(JSON.stringify(arr));
					/* if(ReportName1 != "Unload")
					 {*/

					//}
				} else
					getLangText("Please Select Document.");
			} catch (ex) {
				alert(ex);
			}
			//localStorage.po ='information';

			//window.location = "../review/printoption.html";
		}
		//-------------
		var arr1 = [];
		function PrintSelectedReports() {

			GetSelectedReports("VanStockReport");
			GetSelectedReports("Unload");

			if (arr1.length > 0)
				ReportsToPrint(arr1, 0);
		}

		function GetSelectedReports(ReportName) { // alert(ReportName);               
			arr1.push({
				"ReportName" : ReportName
			});
		}
		//-----------------------
		//-------Update routemaster
		function getOfflineSetting(arr) {
			if (platform == 'iPad') {
				Cordova
						.exec(
								function(result) {
									if (result.length > 0) {

									}
								},
								function(error) {
									alert("Error in getting offline setting : "
											+ error);
								},
								"PluginClass",
								"GetdataMethod",
								[ "select itemcodedisplay,inventorycaseinput,loadoutadjustments,enableeodexpenses,ifnull(pdcthreshold,0) pdcthreshold,ifnull(allowgctocash,0) allowgctocash,enablecashonlydiscount,invenoversell,autocalculateloadin,routename from routemaster where routecode = "
										+ sessionStorage.getItem("RouteCode")
										+ " and salesmancode="
										+ sessionStorage
												.getItem("SalesmanCode") ]);
			} else if (platform == 'Android') {
				window.plugins.DataBaseHelper.select(
						"select itemcodedisplay from routemaster where routecode = "
								+ sessionStorage.getItem("RouteCode")
								+ " and salesmancode="
								+ sessionStorage.getItem("SalesmanCode"),
						function(result) {
							result = $.map(result.array, function(item, index) {
								return [ [ item.itemcodedisplay ] ];
							});
							if (result.length > 0) {

								if (result[0][0] == 1) {
									sessionStorage.setItem("CheckCode",
											"alternatecode");
								} else {
									sessionStorage.setItem("CheckCode",
											"ancode");
								}

							}
							copyStatus = 1;
							ReportsToPrint(arr, 0);
						}, function() {
							console.warn("Error calling plugin");
						});
			}

		}
		function PrintDone() {

			window.location = "../information/information.html";
		}
	</script>

</body>
</html>
