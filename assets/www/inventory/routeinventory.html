<!--
 '  Created By   : Pratik Raval
 '  Created Date : 13/02/2012
 '  Description  : This page is used for route inventory screen.
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Van Stock</title>
<meta name="viewport"
	content="width=device-width, initial-scale=1.0;maximum-scale=1.0;user-scalable=0; target-densitydpi=device-dpi">
	<meta name="format-detection" content="telephone=no">
		<link rel="stylesheet" href="../css/style.css" />
		<link rel="stylesheet" href="../css/en.css" lang="en" />
		<link rel="stylesheet" href="../css/jquery.mobile-1.0.min.css" />
		<link rel="stylesheet"
			media="only screen and (min-width: 320px) and (max-width: 600px)"
			href="../css/style_600.css">
			<!--Black P-->
			<link rel="stylesheet"
				media="only screen and (min-width: 600px) and (max-width: 700px)"
				href="../css/style_700.css">
				<!--Iphone 4 P-->
				<link rel="stylesheet"
					media="only screen and (min-width: 700px) and (max-width: 800px)"
					href="../css/style_800.css">
					<!--Ipad P-->

					<!--Black L-->
					<link rel="stylesheet"
						media="only screen and (min-width: 1000px) and (max-width: 1200px)"
						href="../css/style_1200.css">
						<!--Ipad L-->
						<link rel="stylesheet"
							media="only screen and (min-width: 1200px) and (max-width: 1500px)"
							href="../css/style_1400.css">

							<link rel="stylesheet" href="../css/boostrap/css/bStyle.css" />
							<link rel="stylesheet"
								href="../css/boostrap/css/bootstrap.min.css" />
							<link rel="stylesheet"
								href="../css/boostrap/css/bootstrap-grid.css" />
							<link rel="stylesheet"
								href="../css/boostrap/css/bootstrap-grid.min.css" />
							<link rel="stylesheet" href="../css/boostrap/css/bootstrap.css" />

							<script>
								if (navigator.userAgent.toLowerCase().match(
										/android/)) {
									document
											.write('<script charset="utf-8" src="../cordova-2.0.0.js"><\/script>');
									document
											.write('<script charset="utf-8" src="../directoryListing.js"><\/script>');
								} else if (navigator.userAgent.toLowerCase()
										.match(/iphone/)
										|| navigator.userAgent.toLowerCase()
												.match(/ipad/)) {
									document
											.write('<script charset="utf-8" src="../cordova-1.5.0.js"><\/script>');
								}
							</script>
							<script type="text/javascript" src="../js/jquery.js"></script>

							<script type="text/javascript" src="../js/jquery.mobile-1.0.js"></script>

							<script type="text/javascript" src="../js/common.js"></script>
							<script src="../LangJS/jquery-lang.js" charset="utf-8"
								type="text/javascript"></script>
							<script src="../LangJS/langpack/AR.js" charset="utf-8"
								type="text/javascript" lang="en"></script>

							<!--<script type="application/javascript" src="../js/iscroll.js"></script>
    <script type="text/javascript">

        var scrollContent;
        function loaded() {
           // scrollContent = new iScroll('contentWrapper');
        }
        document.addEventListener('touchmove', function(e) { e.preventDefault(); }, false);
        document.addEventListener('DOMContentLoaded', loaded, false);  

    </script>-->
</head>
<body>
	<div data-role="page" data-theme="d" data-title="Order Request">
		<div>
			<img title="" alt="" src="../images/bg.png" id="background">
		</div>
		<div data-role="header" data-position="inline" id="bgclheader">
			<a href="inventory.html" id="Back_inner" rel="external" lang="en">Back</a>
			<div class="wrapper">
				<div class="card_content">
					<div>
						<img title="" alt="" data-pushbar-target="left"
							src="../images/icons8-menu-50.png" id="setting">
					</div>
				</div>
			</div>
			<h1 lang="en">Van Stock</h1>
			<a href="#" id="lang_inner">EN</a>
		</div>
		<div data-role="content" class="centerboxInvReq">
			<div class="com_div comm  captionLabel"
				style="height: 810px !important;">
				<div class="tblBox tbltd" style="height: 100%">
					<table id="tblHeaderContent" class="tblHeader" cellpadding="0"
						cellspacing="0" border="0" width="100%">
						<tr>
							<th style="width: 10%;" class="leftAlign" lang="en">Code</th>
							<th style="width: 45%;" class="leftAlign" lang="en">
								Description</th>
							<th style="width: 12%;" lang="en">Cases</th>
							<th style="width: 12%;" lang="en">Units</th>
							<th style="width: 16%;" lang="en" class="last">Total</th>

						</tr>
					</table>
					<div id="contentWrapper" class="tblFixedHeight"
						style="height: 100% !important">
						<table id="tblContent" cellpadding="0" cellspacing="0" border="2"
							width="100%" style="height: 100% !important">
							<tr style="height:0px !important">
								<td style="width: 10%; font-size: 22px;" class="leftAlign"></td>
								<td style="width: 45%; font-size: 22px;" class="leftAlign"></td>
								<td style="width: 12%; font-size: 22px;"></td>
								<td style="width: 12%; font-size: 22px;"></td>
								<td style="width: 16%; font-size: 22px;" class="last"></td>
							</tr>
						</table>
					</div>
					<!--  <table id="tblHeaderContent2" class="tblHeader" cellpadding="0" cellspacing="0" border="0" width="100%" style="display:none">
                        <tr>
                            <th style="width: 20%;" class="leftAlign" lang="en">
                                Item Code
                            </th>
                            <th style="width: 35%;" class="leftAlign" lang="en">
                                Item Description
                            </th>
                            <th style="width: 15%;" lang="en">
                                Case Price
                            </th>
                            <th style="width: 15%;" lang="en">
                                Unit Price
                            </th>
                            <th style="width: 15%;" lang="en">
                                UPC
                            </th>                
                        </tr>
                    </table>
                    <div id="contentWrapper2" class="tblFixedHeight" style="display:none">
                        <table id="tblContent2" cellpadding="0" cellspacing="0" border="0" width="100%">
                            <tr>
                                <td style="width: 20%;" class="leftAlign"></td>
                                <td style="width: 35%;" class="leftAlign"></td>
                                <td style="width: 15%;"></td>
                                <td style="width: 15%;"></td>
                                <td style="width: 15%;" class="last"></td>
                            </tr>
                        </table>
                    </div>-->
				</div>
				<!--  <div class="tabedBar">
                    <div id="TabPanel" class="TabPanelEN">
                        <div id="TabQuantity" class="Tab TabFirst TabActive" style="display:block" db="TQ" lang="en">Quantity</div>
                        <div id="TabListPrice" class="Tab TabLast" db="TL" lang="en" style="display:none;white-space:nowrap">List Price</div>
                    </div>
                </div>-->

			</div>


			<div class="leftbotSync card border-info !important">
				<div class="row">
					<div class="col-3"></div>
					<div class="col-3" style="margin-top: 10px !important">
						<div class="card bg-success text-center" style="width: 100%">
							<a href="#" id="printVan" onclick="printvanstock();"
								rel="external"> <img class="bottomicon"
								src="../images/print.png" alt="sync" />
								<h4 class="text-white">PRINT</h4>
							</a>
						</div>

					</div>
					<div class="col-3" style="margin-top: 10px !important">
						<div class="card bg-danger text-center" style="width: 100%">
							<a href="inventory.html" rel="external" id="simplestring"
								data-role="none"> <img class="bottomicon"
								src="../images/icn-exit.png" id="imgexit" alt="Exit" />
								<h4 class="text-white">DONE</h4>
							</a>
						</div>

					</div>
					<div class="col-3"></div>
				</div>
				<!-- <div class="menuPadding">&nbsp;</div>
				
				
				<div class="menuPadding">&nbsp;</div>
				
				<div class="menuPadding">&nbsp;</div> -->
			</div>



		</div>
		<div id="f1" data-role="footer" class="ui-bar">
			<div class="footer">
				<div class="leftfooter">09 November 2011</div>
				<div class="rightfooter">Mirnah Technology Systems</div>
			</div>
		</div>
		<div id="f2" data-role="footer" style="bottom: 0; position: absolute;">
			<aside data-pushbar-id="left" class="pushbar from_left">
			<div class="title">
				<span data-pushbar-close class="close push_right"></span> <span
					id="txtroute"></span>
			</div>

			<ul class="menu">
				<li style="margin-bottom: 0 !important;"><img title="" alt=""
					src="../images/startday-icon.png" id="day" class="leftmenu">
						<a href="#" class="ui-btn-active" rel="external" id="day"
						data-icon="custom" lang="en"
						onclick="footerredict('../startofday/startofday.html')">Start
							day</a></li>
				<li style="margin-bottom: 0 !important;"><img title="" alt=""
					src="../images/Inventoryicon.png" id="inve" class="leftmenu">
						<a href="#" id="inve" rel="external" data-icon="custom" lang="en"
						onclick="footerredict('../inventory/inventory.html')">Inventory</a></li>
				<li style="margin-bottom: 0 !important;"><img title="" alt=""
					src="../images/customer-icon.png" id="cust" class="leftmenu">
						<a href="#" rel="external" id="cust" data-icon="custom" lang="en"
						onclick="footerredict('../customer/customer_operation.html')">Customer</a></li>
				<li style="margin-bottom: 0 !important;"><img title="" alt=""
					src="../images/Money-icon.png" id="sett" class="leftmenu"> <a
						href="#" rel="external" id="sett" data-icon="custom" lang="en"
						onclick="footerredict('../settlement/managesettlement.html')">Settlement</a></li>
				<li style="margin-bottom: 0 !important;"><img title="" alt=""
					src="../images/expense-icon.png" id="expe" class="leftmenu">
						<a href="#" rel="external" id="expe" data-icon="custom" lang="en"
						onclick="footerredict('../settlement/expenseentry.html')">Expenses</a></li>
				<li style="margin-bottom: 0 !important;"><img title="" alt=""
					src="../images/information-icon.png" id="info" class="leftmenu">
						<a href="#" rel="external" id="info" data-icon="custom" lang="en"
						onclick="footerredict('../information/information.html')">Information</a></li>
				<li style="margin-bottom: 0 !important;"><img title="" alt=""
					src="../images/user-settings-icon.png" id="setup" class="leftmenu">
						<a href="#" rel="external" id="setup" data-icon="custom" lang="en"
						onclick="footerredict('../utilities/utilities.html')">Utilities</a></li>
			</ul>

			</aside>
			<div data-role="navbar" data-iconpos="top" data-grid="f">
				<ul>
					<li style="margin-bottom: 0 !important;"><a href="#"
						rel="external" id="day" data-icon="custom" lang="en"
						onclick="footerredict('../startofday/startofday.html')">Start
							day</a></li>
					<li style="margin-bottom: 0 !important;"><a href="#" id="inve"
						class="ui-btn-active" rel="external" data-icon="custom" lang="en">Inventory</a></li>
					<li style="margin-bottom: 0 !important;"><a href="#"
						rel="external" id="cust" data-icon="custom" lang="en"
						onclick="footerredict('../customer/customer_operation.html')">Customer</a></li>
					<li style="margin-bottom: 0 !important;"><a href="#"
						rel="external" id="sett" data-icon="custom" lang="en"
						onclick="footerredict('../settlement/managesettlement.html')">Settlement</a></li>
					<li style="margin-bottom: 0 !important;"><a href="#"
						rel="external" id="expe" data-icon="custom" lang="en"
						onclick="footerredict('../settlement/expenseentry.html')">Expenses</a></li>
					<li style="margin-bottom: 0 !important;"><a href="#"
						rel="external" id="info" data-icon="custom" lang="en"
						onclick="footerredict('../information/information.html')">Information</a></li>
					<li style="margin-bottom: 0 !important; width: 14.0%"><a
						href="#" rel="external" id="setup" data-icon="custom" lang="en"
						onclick="footerredict('../utilities/utilities.html')">Utilities</a></li>
				</ul>
			</div>
		</div>
	</div>


	<script type="text/javascript">
		var data = null;
		var platform = '';
		var routekey = '';
		var detailkey = '';
		var inputvalue = '';
		var CaseEnabled = true;
		var transactiontype = 23;
		var decimalplace = sessionStorage.getItem("decimalplace");
		var page = "#";
		var DocumentNumber, InvoiceNumber;
		var printstatus = 0;
		window.lang = new jquery_lang_js();
		$("#tblContent").click(function() {
		});
		resizeOrientationWindow();
		$(document)
				.ready(
						function() {
							resizeWindow();
							localStorage.batchtranstype = 25;
							if (sessionStorage.getItem("CaseEnabled") == "0"
									|| sessionStorage.getItem("CaseEnabled") == null)
								CaseEnabled = false;
							else if (sessionStorage.getItem("CaseEnabled") == "1")
								CaseEnabled = true;

							if (!CaseEnabled) {
								$("#tblHeaderContent tr th:eq(2)").remove();
								$("#tblContent tr td:eq(2)").remove();

							}
							$.mobile.showPageLoadingMsg();
							document.addEventListener("deviceready", getRecord,
									false);

							// sujee added side bar ----------------- START ------------------------ 

							var pushbar = new Pushbar({
								blur : true,
								overlay : true,
							});
							$("#txtroute").text(
									"ROUTE #: "
											+ sessionStorage
													.getItem("RouteCode"));
							window.setInterval(function() {
								var randomColor = '#'
										+ ('000000' + Math.floor(
												Math.random() * 16777215)
												.toString(16)).slice(-6);
								$('#txtroute').css({
									'color' : randomColor,
								});
							}, 2000);
							//----------------------------- END -------------------------  
							platform = sessionStorage.getItem("platform");
							routekey = sessionStorage.getItem("RouteKey");

							$(".leftfooter").html(getCurrentDate());
							//Setting Tab Styles
							$("#TabPanel div").click(
									function() {
										data = $(this).attr("db");
										$("#TabPanel div").removeClass(
												"TabActive");
										$(this).removeClass("TabInactive")
												.addClass("TabActive");
									});

							$("#TabPanel div:eq(1)").click(
									function() {

										getRecord1();
										$('#tblHeaderContent2').css("display",
												"table");
										$('#tblHeaderContent').css("display",
												"none");
										$('#contentWrapper2').css("display",
												"block");
										$('#contentWrapper').css("display",
												"none");
									});
							$("#TabPanel div:eq(0)").click(function() {
								getRecord();

								$('#tblHeaderContent2').css("display", "none");
								$('#tblHeaderContent').css("display", "table");
								$('#contentWrapper2').css("display", "none");
								$('#contentWrapper').css("display", "block");
							});

							if (sessionStorage.getItem('batchsetting') == 0) {
								$("#lnkBatch").attr("href", "#");
								$("#lnkBatch").attr("onclick", "");
								$("#imgBatch").attr("src",
										"../images/batch-gray.png");
								$("#lnkBatchText").addClass('MenuGray');
							}

							//Alternate table row style

							var lan = sessionStorage.getItem("Language");
							window.lang.run(lan);
							if (sessionStorage.getItem("Language") != "en") {

								window.lang.change('RouteInventory' + lan, lan);
								window.lang.change('Footer' + lan, lan);
								if (lan == "AR") {
									$(".centerboxInvReq").attr("dir", "rtl");
									$('#Back_inner')
											.removeClass(
													'ui-btn-left ui-btn ui-btn-corner-all ui-shadow ui-btn-up-a');
									$('#Back_inner')
											.addClass(
													'ui-btn-right ui-btn ui-btn-corner-all ui-shadow ui-btn-up-a');
									$('#lang_inner')
											.removeClass(
													'ui-btn-right ui-btn ui-btn-corner-all ui-shadow ui-btn-up-a');
									$('#lang_inner')
											.addClass(
													'ui-btn-left ui-btn ui-btn-corner-all ui-shadow ui-btn-up-a');
								}

							} else {
								window.lang.change('en', 'en');
								$(".centerboxInvReq").attr("dir", "ltr");
								$('#Back_inner')
										.removeClass(
												'ui-btn-right ui-btn ui-btn-corner-all ui-shadow ui-btn-up-a');
								$('#Back_inner')
										.addClass(
												'ui-btn-left ui-btn ui-btn-corner-all ui-shadow ui-btn-up-a');
								$('#lang_inner')
										.removeClass(
												'ui-btn-left ui-btn ui-btn-corner-all ui-shadow ui-btn-up-a');
								$('#lang_inner')
										.addClass(
												'ui-btn-right ui-btn ui-btn-corner-all ui-shadow ui-btn-up-a');
							}

						});
		function ClearTable(TBL) {
			$("#" + TBL + " tr:gt(0)").remove();
		}
		//Dynamic Table Generation
		function TableData(result, TBL) {
			ClearTable(TBL);
			var tblHeader = (TBL == 'tblContent') ? 'tblHeaderContent'
					: 'tblHeaderContent2'
			var CellCount = $("#" + tblHeader + " tr:eq(0) th").length;

			data = result;
			inputvalue = result;
			for (i = 0; i < data.length; i++) {
				var r = "<tr class='contentFont'>";
				for (j = 0; j < CellCount; j++) {
					var temp = (j < 2) ? 'class = leftAlign' : '';

					if (TBL == 'tblContent') {
						if (CaseEnabled) {
							if (j == 2 || j == 3) { // CASE OR UNIT

								if (data[i][j] != '')
									data[i][j] = parseInt(data[i][j]);
							}

						} else {
							if (j == 2) { // CASE

								if (data[i][j] != '')
									data[i][j] = parseInt(data[i][j]);
							}

						}
					} else {
						if (CaseEnabled) {
							if (j == 2 || j == 3) {
								if (data[i][j] != '' && data[i][j] != undefined)
									data[i][j] = eval(data[i][j]).toFixed(
											decimalplace);
							}
						} else {
							if (j == 2)
								if (data[i][j] != '' && data[i][j] != undefined)
									data[i][j] = eval(data[i][j]).toFixed(
											decimalplace);
						}
					}
					if (j == CellCount - 1) {
						temp += " style='text-align:center;'";

						if (CaseEnabled) {
							// Total = (case * caseprice) + (Units * salesprice)                                                   
							data[i][j] = eval(data[i][2] * data[i][6])
									+ eval(data[i][3] * data[i][7])
						} else {
							// Total = (Units * salesprice)                  
							data[i][j] = eval(data[i][2] * data[i][5])
						}
						if (isNaN(data[i][j]))
							data[i][j] = 0;

						if (data[i][j] != '' && data[i][j] != undefined)
							data[i][j] = eval(data[i][j]).toFixed(decimalplace);

					}
					if (j == CellCount - 1)
						temp += " class = 'last'";

					var c = "<td " + temp + ">"
							+ (data[i][j] == undefined ? 'N/A' : data[i][j])
							+ "</td>";
					r += c;
				}
				r += "</tr>";
				$('#' + TBL + ' tbody').append(r);
			}
			$.mobile.hidePageLoadingMsg();
			//Refresh alternate table row style and borders
			$("#" + TBL + " tr:odd").addClass('oddRow');
			$("#" + TBL + " tr:even").addClass('evenRow');

			$("#" + TBL + " tr:eq(1)").trigger('click');
			$("#" + TBL + " tr").live('click', function() {
				$(this).addClass('clicked');
				$(this).siblings().removeClass('clicked');
				var idx = $(this).index();
				if (CaseEnabled) {
					var ItemCode = data[idx - 1][5];
				} else {
					var ItemCode = data[idx - 1][4];
				}

				localStorage.selecteditem = ItemCode;
			});
			$("#tblContent tr:odd").addClass('oddRow');
			$("#tblContent tr:even").addClass('evenRow');

			$("#tblContent2 tr:odd").addClass('oddRow');
			$("#tblContent2 tr:even").addClass('evenRow');
		}
		function getRecord() {

			var selectqry = "SELECT max(detailkey) as key from inventorytransactionheader WHERE routecode = "
					+ sessionStorage.getItem("RouteCode")
					+ " and routekey="
					+ sessionStorage.getItem("RouteKey")
					+ " and transactiontype=3";
			if (platform == 'iPad') {
				Cordova
						.exec(
								function(result) {
									if (result[0][0] != '') {
										sessionStorage.setItem("unloaddone", 1);
										var availqty = "ifnull(inventorysummarydetail.endstockqty,0)+ifnull(inventorysummarydetail.unloadqty,0)";
									} else {
										sessionStorage.setItem("unloaddone", 0);
										var availqty = "ifnull(inventorysummarydetail.loadqty,0)+ifnull(inventorysummarydetail.loadadjustqty,0)+ifnull(inventorysummarydetail.beginstockqty,0)+ifnull(loadaddqty,0)-ifnull(loadcutqty,0)-ifnull(saleqty,0)+ifnull(returnqty,0)+ifnull(returnfreeqty,0)-ifnull(freesampleqty,0)";
									}
									if (CaseEnabled) {
										var Qry = "select CASE WHEN '"
												+ sessionStorage
														.getItem("CheckCode")
												+ "' = 'alternatecode' THEN itemmaster.alternatecode ELSE itemmaster.actualitemcode END as itemcode,CASE WHEN '"
												+ sessionStorage
														.getItem("Language")
												+ "' = 'en' THEN itemdescription ELSE arbitemdescription END as Desc,case when ("
												+ availqty
												+ ")='' THEN 0 ELSE (CASE WHEN unitspercase=1 THEN 0 ELSE (("
												+ availqty
												+ ")/unitspercase) END) END  as cases,case when ("
												+ availqty
												+ ")='' THEN 0 ELSE (CASE WHEN unitspercase=1 THEN ("
												+ availqty
												+ ") ELSE (("
												+ availqty
												+ ")%unitspercase) END) END as units,unitspercase,itemmaster.actualitemcode from inventorysummarydetail join itemmaster on itemmaster.actualitemcode=inventorysummarydetail.itemcode where routekey="
												+ routekey
												+ " and ("
												+ availqty
												+ ") > 0 order by CASE printsequenceroute WHEN 0 THEN 100000 ELSE printsequenceroute END";
									} else {
										var Qry = "select CASE WHEN '"
												+ sessionStorage
														.getItem("CheckCode")
												+ "' = 'alternatecode' THEN itemmaster.alternatecode ELSE itemmaster.actualitemcode END as itemcode,CASE WHEN '"
												+ sessionStorage
														.getItem("Language")
												+ "' = 'en' THEN itemdescription ELSE arbitemdescription END as Desc,case when ("
												+ availqty
												+ ")='' THEN 0 ELSE (("
												+ availqty
												+ ")%unitspercase) END as units,unitspercase,itemmaster.actualitemcode,itemmaster.defaultsalesprice as defaultsalesprice from inventorysummarydetail join itemmaster on itemmaster.actualitemcode=inventorysummarydetail.itemcode where routekey="
												+ routekey
												+ " and ("
												+ availqty
												+ ") > 0 order by CASE printsequenceroute WHEN 0 THEN 100000 ELSE printsequenceroute END";
									}
									Cordova.exec(function(result) {
										TableData(result, "tblContent")
									}, function(error) {
										alert(error);
									}, "PluginClass", "GetdataMethod", [ Qry ]);
								}, function(error) {
									alert(error);
								}, "PluginClass", "GetdataMethod",
								[ selectqry ]);
			}

			else if (platform == 'Android') {
				window.plugins.DataBaseHelper
						.select(
								selectqry,
								function(result) {
									var result = $.map(result.array, function(
											item, index) {

										return [ [ item.key ] ];
									});

									if (result[0][0] > 0) {
										$("#printVan").attr("onclick", "");
										$("#printVan").attr("href", "");
										$("#imgPrint").attr("src",
												"../images/print-gray.png");

										sessionStorage.setItem("unloaddone", 1);
										var availqty = "ifnull(inventorysummarydetail.endstockqty,0)";
									} else {
										sessionStorage.setItem("unloaddone", 0);
										var availqty = "ifnull(inventorysummarydetail.loadqty,0)+ifnull(inventorysummarydetail.loadadjustqty,0)+ifnull(inventorysummarydetail.beginstockqty,0)+ifnull(loadaddqty,0)-ifnull(loadcutqty,0)-ifnull(saleqty,0)+ifnull(returnqty,0)+ifnull(returnfreeqty,0)-ifnull(freesampleqty,0)";
									}
									if (CaseEnabled) {
										//var Qry ="select CASE WHEN '" + sessionStorage.getItem("CheckCode") + "' = 'alternatecode' THEN itemmaster.alternatecode ELSE itemmaster.actualitemcode END as itemcode,CASE WHEN '" + sessionStorage.getItem("Language") + "' = 'en' THEN itemdescription ELSE arbitemdescription END as Desc,case when ("+availqty+")='' THEN 0 ELSE (("+availqty+")/unitspercase) END  as cases,case when ("+availqty+")='' THEN 0 ELSE (("+availqty+")%unitspercase) END as units,unitspercase,itemmaster.actualitemcode from inventorysummarydetail join itemmaster on itemmaster.actualitemcode=inventorysummarydetail.itemcode where routekey="+routekey+" and ("+availqty+") > 0 order by CASE printsequenceroute WHEN 0 THEN 100000 ELSE printsequenceroute END";
										//upc 1 change for alghanim
										var Qry = "select CASE WHEN '"
												+ sessionStorage
														.getItem("CheckCode")
												+ "' = 'alternatecode' THEN itemmaster.alternatecode ELSE itemmaster.actualitemcode END as itemcode,CASE WHEN '"
												+ sessionStorage
														.getItem("Language")
												+ "' = 'en' THEN itemdescription ELSE arbitemdescription END as Desc,case when ("
												+ availqty
												+ ")='' THEN 0 ELSE (CASE WHEN unitspercase=1 THEN 0 ELSE (("
												+ availqty
												+ ")/unitspercase) END )  END  as cases,case when ("
												+ availqty
												+ ")='' THEN 0 ELSE (CASE WHEN unitspercase=1 THEN ("
												+ availqty
												+ ")   ELSE (("
												+ availqty
												+ ")%unitspercase) END) END as units,unitspercase,itemmaster.actualitemcode,itemmaster.caseprice as caseprice,itemmaster.defaultsalesprice as defaultsalesprice from inventorysummarydetail join itemmaster on itemmaster.actualitemcode=inventorysummarydetail.itemcode where routekey="
												+ routekey
												+ " and ("
												+ availqty
												+ ") > 0 order by CASE printsequenceroute WHEN 0 THEN 100000 ELSE printsequenceroute END";

									} else {
										var Qry = "select CASE WHEN '"
												+ sessionStorage
														.getItem("CheckCode")
												+ "' = 'alternatecode' THEN itemmaster.alternatecode ELSE itemmaster.actualitemcode END as itemcode,CASE WHEN '"
												+ sessionStorage
														.getItem("Language")
												+ "' = 'en' THEN itemdescription ELSE arbitemdescription END as Desc,case when ("
												+ availqty
												+ ")='' THEN 0 ELSE (("
												+ availqty
												+ ")) END as units,unitspercase,itemmaster.actualitemcode,itemmaster.defaultsalesprice as defaultsalesprice from inventorysummarydetail join itemmaster on itemmaster.actualitemcode=inventorysummarydetail.itemcode where routekey="
												+ routekey
												+ " and ("
												+ availqty
												+ ") > 0 order by CASE printsequenceroute WHEN 0 THEN 100000 ELSE printsequenceroute END";
									}
									console.log(Qry);
									window.plugins.DataBaseHelper
											.select(
													Qry,
													function(result) {
														var result = $
																.map(
																		result.array,
																		function(
																				item,
																				index) {
																			if (CaseEnabled)
																				return [ [
																						item.itemcode,
																						item.Desc,
																						item.cases,
																						item.units,
																						item.unitspercase,
																						item.actualitemcode,
																						item.caseprice,
																						item.defaultsalesprice ] ];
																			else
																				return [ [
																						item.itemcode,
																						item.Desc,
																						item.units,
																						item.unitspercase,
																						item.actualitemcode,
																						item.defaultsalesprice ] ];
																		});

														if (result != null
																&& result != ''
																&& result != undefined
																&& result.length > 0) {
															TableData(result,
																	"tblContent")

														} else {
															$.mobile
																	.hidePageLoadingMsg();
															$("#printVan")
																	.attr(
																			"onclick",
																			"");
															$("#printVan")
																	.attr(
																			"href",
																			"");
															$("#imgPrint")
																	.attr(
																			"src",
																			"../images/print-gray.png");

														}

													},
													function() {
														console
																.warn("Error calling plugin");
													});
								}, function() {
									console.warn("Error calling plugin");
								});

			}
		}
		//----------
		//----Start Made Chage by mirnah 9/1/2014 
		function PrintVanStockAndExit() {
			if (printstatus == 0 || printstatus == 1)
				getVanInfo();
			else
				window.location = 'inventory.html';

		}
		//--------End
		function PrintDone() {
			var path;
			if (platform == "iPad")
				path = "inventory.html";
			else if (platform == "Android")
				path = "../inventory/inventory.html";

			window.location = path;

		}
		//-----------
		function getRecord1() {

			if (CaseEnabled) {
				var Qry = "select CASE WHEN '"
						+ sessionStorage.getItem("CheckCode")
						+ "' = 'alternatecode' THEN itemmaster.alternatecode ELSE itemmaster.actualitemcode END as itemcode,CASE WHEN '"
						+ sessionStorage.getItem("Language")
						+ "' = 'en' THEN itemdescription ELSE arbitemdescription END as Desc,caseprice,defaultsalesprice,unitspercase,itemmaster.actualitemcode from itemmaster left join inventorysummarydetail on itemmaster.actualitemcode=inventorysummarydetail.itemcode and routekey="
						+ routekey
						+ " order by CASE printsequenceroute WHEN 0 THEN 100000 ELSE printsequenceroute END";
			} else {
				var Qry = "select CASE WHEN '"
						+ sessionStorage.getItem("CheckCode")
						+ "' = 'alternatecode' THEN itemmaster.alternatecode ELSE itemmaster.actualitemcode END as itemcode,CASE WHEN '"
						+ sessionStorage.getItem("Language")
						+ "' = 'en' THEN itemdescription ELSE arbitemdescription END as Desc,defaultsalesprice,unitspercase,itemmaster.actualitemcode from itemmaster left join inventorysummarydetail on itemmaster.actualitemcode=inventorysummarydetail.itemcode and routekey="
						+ routekey
						+ " order by CASE printsequenceroute WHEN 0 THEN 100000 ELSE printsequenceroute END";
			}

			if (platform == 'iPad') {
				Cordova.exec(function(result) {
					TableData(result, "tblContent2")
				}, function(error) {
					alert(error);
				}, "PluginClass", "GetdataMethod", [ Qry ]);
			} else if (platform == 'Android') {
				window.plugins.DataBaseHelper.select(Qry, function(result) {
					var result = $.map(result.array, function(item, index) {
						if (CaseEnabled)
							return [ [ item.itemcode, item.Desc,
									item.caseprice, item.defaultsalesprice,
									item.unitspercase, item.actualitemcode ] ];
						else
							return [ [ item.itemcode, item.Desc,
									item.defaultsalesprice, item.unitspercase,
									item.actualitemcode ] ];
					});

					if (result.length > 0) {
						TableData(result, "tblContent2");
					} else {
						$.mobile.hidePageLoadingMsg();
						$("#printVan").attr("onclick", "");
						$("#printVan").attr("href", "");
						$("#imgPrint").attr("src", "../images/print-gray.png");
					}

				}, function() {
					console.warn("Error calling plugin");
				});
			}
		}

		function printvanstock() {

			localStorage.printinv = 'vanstock'
			window.location = 'printoption_van.html';

		}
	</script>

</body>
</html>
